{
	"$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json",
	"view": {
		"kind": "Form",
		"properties": {
			"title": "Web App deployment wizard",
			"steps": [
				{
					"name" : "basics",
                    "label": "Deployment location",
                    "elements": [
                        {
                            "name": "resourceScope",
                            "type": "Microsoft.Common.ResourceScope"
                        }
                    ]
				},
				{
					"name": "admeDetails",
					"label": "ADME Details",
                    "text": "Enter the details for the ADME deployment",
					"elements": [
                        {
                            "name": "admeEndpoint",
                            "type": "Microsoft.Common.Text",
                            "label": "ADME Endpoint",
                            "toolTip": "The base URL of the ADME deployment",
                            "defaultValue": "https://<contoso>.energy.azure.com",
                            "constraints": {
                                "required": true,
                                "regex": "^https://[a-zA-Z0-9-]+\\.energy\\.azure\\.com$",
                                "validationMessage": "The ADME endpoint must be a valid URL",
                                "minLength": 26,
                                "maxLength": 41
                            },
                            "visible": true
                        },
                        {
                            "name": "admeDataPartition",
                            "type": "Microsoft.Common.Text",
                            "label": "ADME Data Partition",
                            "toolTip": "The data partition ID for the ADME deployment",
                            "defaultValue": "data",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-zA-Z0-9-]+$",
                                "validationMessage": "The ADME data partition must be a valid string",
                                "minLength": 1,
                                "maxLength": 31
                            },
                            "visible": true
                        },
                        {
                            "name": "admeClientId",
                            "type": "Microsoft.Common.Text",
                            "label": "ADME Client ID",
                            "toolTip": "The client ID for the ADME deployment",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-zA-Z0-9-]+$",
                                "validationMessage": "The ADME client ID must be a valid string",
                                "minLength": 1,
                                "maxLength": 31
                            },
                            "visible": true
                        },
                        {
                            "name": "admeClientSecret",
                            "type": "Microsoft.Common.Text",
                            "label": "ADME Client Secret",
                            "toolTip": "The client secret for the ADME deployment",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-zA-Z0-9-]+$",
                                "validationMessage": "The ADME client secret must be a valid string",
                                "minLength": 1,
                                "maxLength": 31
                            },
                            "visible": true,
                            "secure": true
                        }
                    ]
                },
                {
                    "name": "postgreSqlDetails",
                    "label": "Database",
                    "text": "Enter the details for the PostgreSQL deployment",
                    "elements": [
                        {
                            "Name": "adminUsername",
                            "type": "Microsoft.Compute.UserNameTextBox",
                            "label": "User name",
                            "defaultValue": "",
                            "toolTip": "",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-z0-9A-Z]{1,30}$",
                                "validationMessage": "Only alphanumeric characters are allowed, and the value must be 1-30 characters long."
                            },
                            "visible": true
                        },
                        {
                            "Name": "adminPassword",
                            "type": "Microsoft.Compute.CredentialsCombo",
                            "label": {
                                "password": "Password",
                                "confirmPassword": "Confirm password"
                            },
                            "toolTip": {
                                "password": ""
                            },
                            "constraints": {
                                "required": true,
                                "customPasswordRegex": "^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                                "customValidationMessage": "The password must be alphanumeric, contain at least 12 characters, and have at least 1 letter and 1 number."
                            },
                            "options": {
                                "hideConfirmation": false
                            },
                            "osPlatform": "Windows",
                            "visible": true
                        },
                        {
                            "Name": "modelDatabaseName",
                            "type": "Microsoft.Common.Text",
                            "label": "Database Name",
                            "toolTip": "The name of the Production DMS Model database",
                            "defaultValue": "dspdm_model",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-zA-Z0-9-]+$",
                                "validationMessage": "The database name must be a valid string",
                                "minLength": 1,
                                "maxLength": 31
                            },
                            "visible": true
                        },
                        {
                            "Name": "serviceDatabaseName",
                            "type": "Microsoft.Common.Text",
                            "label": "Database Name",
                            "toolTip": "The name of the Production DMS Service database",
                            "constraints": {
                                "required": true,
                                "regex": "^[a-zA-Z0-9-]+$",
                                "validationMessage": "The database name must be a valid string",
                                "minLength": 1,
                                "maxLength": 31
                            },
                            "visible": true
                        }
                    ]
                },
                {
                    "name": "containerAppsDetails",
                    "label": "Container Apps",
                    "text": "Enter the details for the container apps deployment",
                    "elements": [
                        {
                            "name": "containerAppsConsumptionPlan",
                            "type": "Microsoft.Common.DropDown",
                            "label": "Consumption Plan",
                            "toolTip": "The plan that defines how resources are allocated to the container apps. [Learn more](https://learn.microsoft.com/en-us/azure/container-apps/workload-profiles-overview).",
                            "constraints": {
                                "required": true,
                                "allowedValues": [
                                    {
                                        "label": "Consumption",
                                        "description": "Suitable for development and testing scenarios.",
                                        "value": "Consumption"
                                    },
                                    {
                                        "label": "Premium",
                                        "description": "Suitable for production scenarios. Uses the D4 workload profile.",
                                        "value": "D4"
                                    }
                                ]
                            },
                            "visible": true
                        },
                        {
                            "name": "containerImage",
                            "type": "Microsoft.Common.Text",
                            "label": "Container Image",
                            "toolTip": "The URL of the container image to deploy. See the Production DMS [Container Registry](https://<contoso>.azurecr.io) for available images.",
                            "defaultValue": "https://<contoso>.azurecr.io/<image>:<tag>",
                            "constraints": {
                                "required": true,
                                "regex": "^(https?:\\/\\/).+$",
                                "validationMessage": "The container image URL must be a valid URL"
                            },
                            "visible": true
                        }
                    ]
                }
            ]
        }
    }
}